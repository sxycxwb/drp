@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_LayoutIndex.cshtml";
}
<link href="~/Content/css/framework-font.css" rel="stylesheet" />
<link href="~/Content/css/framework-theme.css" rel="stylesheet" />
<script src="~/Content/js/jsrender/jsrender.min.js"></script>
<link href="~/Content/js/select2/select2.min.css" rel="stylesheet" />
<script src="~/Content/js/select2/select2.min.js"></script>
<script src="~/Content/js/select2/zh-CN.js"></script>
<script src="~/Content/js/validate/jquery.validate.min.js"></script>
<script src="~/Content/js/datepicker/WdatePicker.js"></script>
<link href="~/Content/css/framework-ui.css" rel="stylesheet" />
<script src="~/Content/js/framework-ui.js"></script>
<script>
    var keyValue = $.request("keyValue");
    $(function () {
        $('#layout').layout();
        treeView();
        gridList();
    });

    function treeView() {
        $("#categroyTree").treeview({
            url: "/DrpServManage/ProductCategory/GetTreeJson",
            onnodeclick: function (item) {
                $("#txt_keyword").val('');
                $("#gridList").jqGrid('setGridParam', {
                    url: "/DrpServManage/Product/GetGridJson",
                    postData: { categoryId: $("#categroyTree").getCurrentNode().id, keyword: $("#txt_keyword").val() },
                }).trigger('reloadGrid');
            }
        });
    }

    function gridList() {
        var $gridList = $("#gridList");
        $gridList.dataGrid({
            //url: "/DrpServManage/Product/GetGridJson",
            height: $(window).height() - $(document).height()/2-85,
            colModel: [
                { label: '主键', name: 'F_Id', hidden: true },
                { label: '产品名称', name: 'F_ProductName', width: 180, align: 'left' },
                {
                    label: '计费模式',
                    name: 'F_ChargePattern',
                    width: 70,
                    align: 'left',
                    formatter: function (cellvalue) {
                        if (cellvalue == "0") {
                            return "产品";
                        } else if (cellvalue == "1") {
                            return "模块";
                        }
                    }
                },
                {
                    label: '成本价(元)',
                    name: 'F_CostPrice',
                    width: 100,
                    align: 'left',
                    formatter: function (cellvalue) {
                        return cellvalue.toFixed(2);
                    }
                },
                {
                    label: '销售价(元)',
                    name: 'F_ChargeAmount',
                    width: 100,
                    align: 'left',
                    formatter: function (cellvalue) {
                        return cellvalue.toFixed(2);
                    }
                },
                { label: '计费方式', name: 'F_ChargeStyle', width: 70, align: 'left' },
                { label: '产品描述', name: 'F_Description', width: 250, align: 'left' }
            ],
            pager: "#gridPager",
            sortname: 'F_CreatorTime desc',
            viewrecords: true
        });
        
    }

    function initControl() {
        $('input').iCheck({
            checkboxClass: 'icheckbox_flat-green'
        });
    }

    function submitForm() {
        var str = "";
        var ids = "";
        $("input[name='pck']:checkbox").each(function () {
            if (true == $(this).is(':checked')) {
                str += $(this).val() + ",";
            }
        });
        if (str.substr(str.length - 1) == ',') {
            ids = str.substr(0, str.length - 1);
        }
        $.submitForm({
            url: "/DrpServManage/Customer/SubmitProduct",
            param: { productIds: ids, keyValue: keyValue },
            success: function () {
                $.currentWindow().$("#gridList").trigger("reloadGrid");
            }
        });
    }
</script>
<style>
    .checkProduct {
        margin-left: 10px;
        font-size: 14px;
    }
</style>
<div class="ui-layout" id="layout" style="height: 50%; width: 100%;">
    <div class="ui-layout-west">
        <div id="categroyTree"></div>
    </div>
    <div class="ui-layout-center">
        <div class="gridPanel" style="margin-top: 5px;">
            <table id="gridList"></table>
            <div id="gridPager"></div>
        </div>
    </div>
</div>

<form id="form1" ng-app="app">
    <table class="form">
        <tr>
            <th class="formTitle"><span class="required-span">*</span>产品名称</th>
            <td class="formValue">
                <input id="F_ProductName" name="F_FullName" type="text" class="form-control required" placeholder="请输入名称" />
            </td>
            <th class="formTitle"><span class="required-span">*</span>计费模式</th>
            <td class="formValue">
                <select id="F_ChargePattern" name="F_ChargePattern" class="form-control required">
                    <option value="">==请选择==</option>
                    <option value="0" title="expand">产品</option>
                    <option value="1" title="iframe">模块</option>
                </select>
            </td>
        </tr>
        <tr>
            <th class="formTitle">成本价</th>
            <td class="formValue">
                <input id="F_CostPrice" name="F_CostPrice" type="number" class="form-control " style="display: inline-block; width: 180px;" placeholder="请输入成本价"/> <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> 元</span>
            </td>
            <th class="formTitle">销售价</th>
            <td class="formValue">
                <input id="F_ChargeAmount" name="F_ChargeAmount" type="number" class="form-control " style="display: inline-block; width: 180px;" placeholder="请输入销售价"/> <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> 元</span>
            </td>
            <th class="formTitle"><span class="required-span">*</span>代理商提成率</th>
            <td class="formValue">
                <input id="F_RoyaltyRate" name="F_RoyaltyRate" type="number" class="form-control required" style="display: inline-block; width: 180px;" placeholder="请输入提成率" /> <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> %</span>
            </td>
            @*<th class="formTitle">成本价格区间</th>
            <td class="formValue">
                <input id="F_CostPriceMin" name="F_CostPriceMin" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最低价" /> -
                <input id="F_CostPriceMax" name="F_CostPriceMax" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最高价" />
                <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> 元</span>
            </td>*@
        </tr>
        @*<tr>
            
            <th class="formTitle">销售价格区间</th>
            <td class="formValue">
                <input id="F_ChargeAmountMin" name="F_ChargeAmountMin" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最低价" /> -
                <input id="F_ChargeAmountMax" name="F_ChargeAmountMax" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最高价" />
                <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> 元</span>
            </td>
        </tr>*@
        @*<tr>
            
            <th class="formTitle">提成率区间</th>
            <td class="formValue">
                <input id="F_RoyaltyRateMin" name="F_RoyaltyRateMin" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最小值" /> -
                <input id="F_RoyaltyRateMax" name="F_RoyaltyRateMax" type="number" class="form-control " style="display: inline-block; width: 120px;" placeholder="请输入最大值" />
                <span style="display: inline-block; margin-left: 4px; font-weight: bold;"> 元</span>
            </td>
        </tr>*@
        <tr>
            <th class="formTitle"><span class="required-span">*</span>计费方式</th>
            <td class="formValue">
                <select id="F_ChargeStyle" name="F_ChargeStyle" class="form-control required">
                    <option value="">==请选择==</option>
                    <option value="year">年</option>
                    @*<option value="quarter">季度</option>*@
                    <option value="month">月</option>
                    @*<option value="week">周</option>
                        <option value="day">日</option>*@
                </select>
            </td>
            <th class="formTitle"><span class="required-span">*</span>提成规则</th>
            <td class="formValue">
                <select id="F_ChargeRule" name="F_ChargeRule" class="form-control required">
                    <option value="0">去除成本价</option>
                    <option value="1">保留成本价</option>
                </select>
            </td>
        </tr>
    </table>


    @*<div style="margin-top: 10px; margin-left: 10px; margin-right: 10px;">
        <div style="padding-top: 20px; margin-right: 30px;" id="productList">

        </div>
        <script type="text/x-jsrender" id="listTemplate">
            <label class="checkProduct">
                <input type="checkbox" name="pck" value="{{:productId}}" {{if (isChecked)}} checked {{/if}} "> {{:productName}}
            </label>
        </script>
    </div>*@
</form>
